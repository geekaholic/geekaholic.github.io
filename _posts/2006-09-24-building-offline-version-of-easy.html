---
layout: post
title: Building an offline version of Easy Ubuntu - EasyERUbuntu HOWTO
date: '2006-09-24T05:05:00.000-05:00'
author: geekaholic
tags: 
modified_time: '2006-09-24T09:55:14.376-05:00'
blogger_id: tag:blogger.com,1999:blog-8947964.post-115909526258678185
blogger_orig_url: https://www.geekaholic.org/2006/09/building-offline-version-of-easy.html
---

<h2>Motivation</h2><br /><a href="http://www.flickr.com/photos/babytux/251222768/" title="Photo Sharing"><img src="http://static.flickr.com/103/251222768_707dd1ab95_m.jpg" width="240" height="169" alt="easyerubuntu" /></a><br /><a href="http://www.ubuntu.com">Ubuntu</a> has become a popular GNU/Linux distributions and has introduced many new users to the world of GNU/Linux and FOSS. Nevertheless, some felt that new users migrating would find it difficult not being able to perform certain functions such as play DVDs, listening to mp3 etc., even though the platform supports these functions. Getting these packages installed might not be trivial for some newbies even though much of the details has been well documented at <a href="http://ubuntuguide.org">http://ubuntuguide.org</a>.<br /><br /><a href="http://easyubuntu.freecontrib.org">Easy Ubuntu</a> was an attempt to provide a user-friendly front end that made it very easy to install several key packages that were missing in Ubuntu due to possible legal reasons. Unfortunately, the current stable version of Easy Ubuntu doesn’t support an offline mode. The development versions seemed to have a work-in-progress implementation for an offline mode, but that doesn’t seem to support the same user friendly GUI that is available during the network install.<br /><br />EasyER Ubuntu (pronounced Easier Ubuntu) is an attempt to provide a companion CD for Ubuntu that uses a slightly modified version of Easy Ubuntu. Additionally, the CD is aptable, meaning you can add it as an apt resource using the apt-cdrom tool.<br /><h3>Here is how I made this CD:</h3><br /><br />Steps<br /><ul><br />    <li> Downloaded easyubuntu and ran the installer, selecting all packages.</li><br />    <li> Install any other packages. If you want you can use the option –download-only to prevent the package from being installed.</li><br /><code><br />apt-get --download-only install foo<br /></code><br />    <li> Installed apt-move utility and configured it so that it doesn’t actually delete the package cache (as a result of moving)</li><br /><code><br /> # apt-get install apt-move<br /> # vi /etc/apt-move.conf<br /> COPYONLY=yes<br /></code><br />    <li> Created the local apt mirror directory</li><br /><code><br /># rm -rf /mirrors/debian<br /># mkdir -p /mirrors/debian<br /></code><br />    <li> Ran apt-move to copy the debs from the apt archive</li><br /><code><br /># apt-move -d dapper update<br /></code><br />    <li> Because ubuntu repository structure, not all packages are inserted into the Packages.gz file by apt-move. We must remake Packages.gz with the help of apt-ftparchive.</li><br /><code><br /># cd /mirrors/debian/dists/dapper<br /># mkdir -p {non-free,contrib}/binary-i386<br /></code><br />For some reason the non-free and contrib directories were missing even though they were present at the /mirrors/debian/pool/ directory.<br /><code><br /># apt-ftparchive packages pool/main/ | gzip -9c > dists/dapper/main/binary-i386/Packages.gz<br /># apt-ftparchive packages pool/multiverse/ | gzip -9c > dists/dapper/multiverse/binary-i386/Packages.gz<br /># apt-ftparchive packages pool/contrib/ | gzip -9c > dists/dapper/contrib/binary-i386/Packages.gz<br /># apt-ftparchive packages pool/non-free/ | gzip -9c > dists/dapper/non-free/binary-i386/Packages.gz<br /></code><br />Make sure that binary-i386/Release file exists and has the correct component entry.<br /><code><br />Archive: contrib<br />Component: contrib<br />Origin: APT-Move<br />Label: APT-Move<br />Architecture: i386<br /></code><br />    <li> We need to remake the Release file so we first create a template apt configuration file called myapt.conf</li><br /><code><br />APT::FTPArchive::Release {<br />Origin "APT-Move";<br />Label "APT-Move";<br />Suite "dapper";<br />Codename "dapper";<br />Architectures "i386";<br />Components "main multiverse contrib non-free";<br />Description "Ubuntu Updates CD";<br />};<br /><br /># rm dists/dapper/Release<br /># apt-ftparchive -c ~/myapt.conf release dists/dapper/ > Release<br /># mv Release dists/dapper/<br /></code><br />    <li> Next we need to sign the Release file using out GPG key. But first we need to create our GPG key if it doesn’t already exist</li><br /><code><br /># gpg --gen-key<br /># gpg -bao dists/dapper/Release.gpg dists/dapper/Release<br /></code><br />    <li> Next, we delete unwanted .apt-move directory</li><br /><code><br /># rm -rf .apt-move<br /></code><br />    <li> Next we need to identify the cd by making a .disk directory and making an info file in it.</li><br /><code><br /># mkdir .disk<br /># echo EasyERUbuntu `date +%Y-%m-%d` > .disk/info<br /></code><br />    <li> Then we need to put our public keys in it.</li><br /><code><br /># gpg --export -a "Your Name" > public.key<br /></code><br /></ul><br /><h2>Easy Ubuntu Hack</h2><br /><ul><br />    <li> Stop Easy Ubuntu from updating the conf/sources.list file by commenting out detect.replace(confdir) from easyubuntu.in</li><br /><code><br /> ###detect.replace(confdir)<br /></code><br />    <li> Put a static sources.list line that only uses the CD ROM</li><br /><code><br /> deb cdrom:[EasyERUbuntu]/ dapper contrib main multiverse non-free<br /></code><br /><br />where “EasyERUbuntu” is the label of the CD, which we define during mkisofs.<br /><br />    <li> We can further modify the EasyUbuntu script to prevent it from running apt-get update on the CD everytime you install a package, which would cause an annoying error message .</li><br /><br />Edit EasyUbuntu/gtkprocess.py and look for self.manager.remove(”–update-at-startup”) and comment it out. Also comment out the line synaptic.update()<br /><code><br />### self.manager.remove("--update-at-startup") # EasyER Ubuntu Hack<br /><br />### synaptic.update() # EasyER Ubuntu Hack<br /></code><br /></ul><br />Thats it!<br /><br /><h2>Burning and Using</h2><br /><ul><br />    <li> Copy the modified easyubuntu directory to /mirrors/debian.</li><br /><code><br /># tar zcvf /mirrors/debian/easyerubuntu.tar.gz easyubuntu<br /></code><br />    <li> To create the iso</li><br /><code><br /># mkisofs -r -A "EasyERUbuntu" -o ubuntu-companion.iso /mirrors/debian<br /></code><br />    <li> Before you could use the CD, you need to add our GPG key to apt GPG keys</li><br /><code><br /># apt-key add /cdrom/public.key<br /></code><br />    <li> Finally add the CD as a source.</li><br /><code><br /># apt-cdrom add<br /></code><br />    <li> You can now extract the easyerubuntu.tar.gz from the CD to your home directory</li><br /><code><br />$ mount /media/cdrom<br />$ tar zxvf /media/cdrom/ubuntu.tar.gz<br /></code><br />    <li> Now you can execute EasyERUbuntu</li><br /><code><br />$ cd easyubuntu<br />$ ./launchEU.sh<br /></code><br /></ul><br /><span style="font-weight:bold;">Issues: </span> While most packages install properly, not all of them do. Most packages in the system tab don't work. These may require a bit more hacking to get working offline.<br /><br />See Also: <a href="https://help.ubuntu.com/community/AptMoveHowto">AptMoveHowto</a>