---
layout: post
title: Using a download accelerator with apt-get
date: '2007-08-06T12:51:00.001-05:00'
author: geekaholic
tags: 
modified_time: '2008-11-02T08:24:38.339-06:00'
blogger_id: tag:blogger.com,1999:blog-8947964.post-2092375208853042963
blogger_orig_url: https://www.geekaholic.org/2007/08/using-download-accelerator-with-apt-get.html
---

If dist-upgrading your Ubuntu or Debian GNU/Linux distro is taking a considerable amount of time (or says it will), then this might be a useful tip to speed things up a bit.<br /><br />This is nothing new really; something I used to frequently <a href="http://budlite.blogspot.com/2005/02/goodbye-debian-hello-gentoo.html">back in the day</a> when Debian was my primary desktop disto. You see I got sick of waiting for debs to complete downloading, not to mention the apt database being locked, so I wrote a small perl script which used <a href="http://prozilla.genesys.ro/">prozilla</a> to quickly download the debs into /var/cache/apt/archives.<br /><br />Recently, my g/f told me to dist-upgrade her Ubuntu box, since she didn't have broadband @ home and thats when I remembered that I have forgotten where I'd put that script. So I wrote new one that was an even smaller script.<br /><br />But before that, I wrote a tiny bash "one liner" which can also be used download debs but it may not work with some debs that have to be renamed by escaping some characters. But nevertheless it too can be useful for downloading one or two packages with dependencies.<br /><br />I'm assuming your running this as root <br /><code><br /> # cd /var/cache/apt/archives<br /> # apt-get -y --print-uris install package_name > debs.list<br /> # egrep -o -e "(ht|f)tp://[^\']+" debs.list | xargs -l1 axel -a<br /></code><br />Instead of using prozilla, I now use <a href="http://wilmer.gaast.net/main.php/axel.html">axel</a> which is also another download accelerator. You should be able to easily apt-get install axel. Replace package_name with either a package name you are installing or dist-upgrade if you want to upgrade the system altogether. Be warned that you may have to rename some files before apt sees the file as being downloaded completely.<br /><br />Now on to the "slightly longer, works better", perl script:<br /># cd /var/cache/apt/archives<br /># apt-get -y --print-uris install package_name > debs.list<br /># vi download-debs.pl<br /><code><br /><pre><br />#!/usr/bin/perl<br /><br />while(<>){<br /><br /> if(/([^ ]+)[ ]+([^ ]+)[ ]+/){<br />    ($url,$rendeb)=($1,$2);<br />    $url=~s/[' ]//g;<br />    $deb=$url; $deb=~s/.*\///;<br />    $rendeb=~s/[ ]//g;<br />    print "Downloading $deb \n";<br />    system("axel -a $url");<br />    if($deb ne $rendeb){<br />        print "Renaming $deb to $rendeb \n";<br />        system("mv $deb $rendeb");<br />    }<br /> }<br />}<br /></pre><br /></code><br /><br /># ./download-debs.pl debs.list<br /><br />While your waiting for the download you might even be able to squeeze in a few new smaller packages, as the apt database isn't locked. Once the download is complete, just run the same command without the -print-uris option and your good to go. <br /><br />Be warned that using a download accelerator might bring your sys admin running to your desk screaming before you can say "apt-get are we done yet!".