---
layout: post
title: The Linux Speed Boost!
date: '2010-11-21T23:50:00.002-06:00'
author: geekaholic
tags: 
modified_time: '2010-11-22T01:16:45.632-06:00'
blogger_id: tag:blogger.com,1999:blog-8947964.post-7253244008987927904
blogger_orig_url: https://www.geekaholic.org/2010/11/linux-speed-boost.html
---

Oh my, it has been a while since I visited my Blog. While there were few worthy posts which I should have blogged about, that never happened. Recently, when I came across a <a href="http://www.omgubuntu.co.uk/2010/11/linux-to-get-a-lot-faster-due-to-new-patch/">post on OMG Ubuntu</a>, about a new kernel patch which supposedly speeds up Linux, I just had to try it out. Its been a while since I've compiled my own kernel (these days I rely on stock Ubuntu), but after seeing the results myself  thought it was very much blog worthy for me to share with you.<br /><br />First off, for the impatient or the unmotivated, let me <a href="http://www.phoronix.com/scan.php?page=article&item=linux_2637_video&num=2">point you to another post</a> on Phoronix, which contains a video showing the night and day difference this patch brings. If your still not impatient, then you could wait for 2.6.38, which will hopefully have this, considering <a href="http://marc.info/?l=linux-kernel&m=128979084506774&w=2">Linus's supportive comments</a>, regarding the patch.<br /><br />Ok now for the glory details on getting this patch up and running. I did this on Ubuntu 10.10 but it should work the same for other Debian and Debian like distros as well as other popular distros with minor tweaks. <br /><br /><dl><br /><dt>Get the kernel</dt><br /><dd>Download the kernel 2.6.37 from <a href="http://kernel.org">kernel.org</a>. At the time of writing, 2.6.37 had not been officially released and was at RC2<br /><br /><pre><br />cd /usr/src<br />wget http://www.kernel.org/pub/linux/kernel/v2.6/testing/linux-2.6.37-rc2.tar.bz2<br />tar jxf linux-2.6.37-rc2.tar.bz2<br /></pre><br /></dd><br /><br /><dt>Get the patch</dt><br /><dd>The <a href="http://marc.info/?l=linux-kernel&m=128978361700898&w=2">patch published by Mike Galbraith</a> can also be copied from <a href="http://paste-bin.com/view/raw/6e4a38d4">here</a>. Save it to a file called kernelboost.patch in /usr/src/kernelboost.patch<br /></dd><br /><br /><dt>Dry-run and Apply patch</dt><br /><dd>Go to the kernel directory and dry-run the patch to make sure it applies cleanly. If everything is ok, go ahead and apply for real ;)<br /><br /><pre><br />cd /usr/src/linux-2.6.37-rc2<br />patch --dry-run -p1 < /usr/src/kernelboost.patch<br /><br />#if everything is ok<br />patch -p1 < /usr/src/kernelboost.patch<br /></pre><br /></dd><br /><br /><dt>Configure and compile the kernel</dt><br /><dd>This is a generic step of compiling the kernel. The configuring step can be performed using your current config file. Make sure you enable the patch by answering Y to CONFIG_SCHED_AUTOGROUP.<br /><br /><pre><br />cp /boot/config-2.6.35-22-generic /usr/src/linux-2.6.37-rc2/.config<br />make oldconfig<br />make<br />make modules_install<br />make install<br /></pre><br /><br />If your on Ubuntu, I'd recommend <a href="https://wiki.ubuntu.com/KernelTeam/GitKernelBuild">installing the kernel the Debian way</a> instead of using the make, make modules_install and make install steps.<br /><br /><pre><br />apt-get install kernel-package fakeroot build-essential ncurses-dev<br />cd /usr/src/linux-2.6.37-rc2<br />sed -rie 's/echo "\+"/#echo "\+"/' scripts/setlocalversion<br />make-kpkg clean<br />CONCURRENCY_LEVEL=`getconf _NPROCESSORS_ONLN` fakeroot make-kpkg --initrd --append-to-version=-custom kernel_image kernel_headers<br /><br />cd ..<br /></pre><br /></dd><br /></dl><br /><br />You should find two .debs in /usr/src related to the new custom kernel. Install using dpkg -i or by double clicking on the deb from the file manager. Once you reboot to the new kernel everything should be all set. Just to double check make sure :<br /><br /><pre><br />cat /proc/sys/kernel/sched_autogroup_enabled<br />1<br /></pre><br /><br />If it has 1 then its enabled. You can echo 0 > /proc/sys/kernel/sched_autogroup_enabled to disable the scheduler on the fly.<br /><br />I noticed a significant improvement when trying to play <a href="http://store.steampowered.com/agecheck/app/7670/">BioShock from Steam</a> using <a href="http://www.codeweavers.com/products/cxgames/">CrossOver Games</a>. With the previous kernel, I had a lot of lag, especially with Compiz turned on. For instance, when moving the mouse to look around, it was very much discrete. Now I notice things are smoother and the game is much playable.<br /><br />Your experience may be different depending on how you use the computer. Chances are that if you tend to use CPU hogging applications such as playing games or watching HD movies, you will notice an improvement.<br /><br />Till next time a blog worthy event that excites me happens~